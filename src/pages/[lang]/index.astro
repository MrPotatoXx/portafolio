---
import Layout from "@/layouts/Layout.astro";

import About from "@/components/indexsections/About.astro";
import Education from "@/components/indexsections/Education.astro";
import Experience from "@/components/indexsections/Experience.astro";
import Hero from "@/components/indexsections/Hero.astro";
import Projects from "@/components/indexsections/Projects.astro";
import Skills from "@/components/indexsections/Skills.astro";
import Courses from "@/components/indexsections/Courses.astro";

import { getMessages, normalizeLang } from "@/i18n";

export const prerender = true;
export async function getStaticPaths() {
  return [
    { params: { lang: 'es' } },
    { params: { lang: 'en' } },
  ];
}

const { lang } = Astro.params;
const l = normalizeLang(lang);
const t = getMessages(l);

let cv: any;
if (l === 'en') {
  const mod = await import("../../../cv.en.json");
  // Vite/ESM JSON dynamic import returns module with default
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  cv = (mod as any).default ?? mod;
} else {
  const mod = await import("../../../cv.es.json");
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  cv = (mod as any).default ?? mod;
}
---

<Layout title={t.site.title} description={t.site.description} lang={l} t={t} cv={cv}>
  <div class="flex justify-center items-center min-h-screen mt-20">
    <div class="max-w-screen-lg">
      <Hero t={t} cv={cv} />
      <About t={t} cv={cv} />
      <Experience t={t} cv={cv} />
      <Education t={t} cv={cv} />
      <Projects t={t} cv={cv} />
      <Courses t={t} cv={cv} />
      <Skills t={t} cv={cv} />
    </div>
  </div>
</Layout>
